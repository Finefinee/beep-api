//package com.b.beep.global.common\n\nimport com.b.beep.domain.approval.infrastructure.entity.ApprovalEntity\nimport com.b.beep.domain.approval.infrastructure.repo.ApprovalJpaRepository\nimport com.b.beep.adapter.out.persistence.attendance.entity.AttendanceEntity\nimport com.b.beep.adapter.out.persistence.attendance.repo.AttendanceJpaRepository\nimport com.b.beep.domain.user.infrastructure.StudentInfoEntity\nimport com.b.beep.domain.user.infrastructure.UserEntity\nimport com.b.beep.domain.user.infrastructure.StudentInfoJpaRepository\nimport com.b.beep.domain.user.infrastructure.UserJpaRepository\nimport com.b.beep.refactor.domain.attendance.enums.AttendanceType\nimport com.b.beep.refactor.domain.attendance.enums.Room\nimport com.b.beep.domain.user.domain.UserRole\nimport org.springframework.boot.ApplicationRunner\nimport org.springframework.context.annotation.Bean\nimport org.springframework.context.annotation.Configuration\nimport java.time.LocalDate\nimport kotlin.random.Random\n\n@Configuration\nclass RoomDataGenerator(\n    private val userJpaRepository: UserJpaRepository,\n    private val studentInfoJpaRepository: StudentInfoJpaRepository,\n    private val attendanceJpaRepository: AttendanceJpaRepository,\n    private val approvalJpaRepository: ApprovalJpaRepository\n) {\n    @Bean\n    fun initializeData(): ApplicationRunner {\n        return ApplicationRunner {\n            if (userJpaRepository.count() == 0L) {\n                println(\"데이터 생성 시작\")\n\n                // Approval 데이터 생성\n                val periods = listOf(8, 9, 10)\n                val rooms = Room.values()\n                val approvals = rooms.flatMap { room ->\n                    periods.map {\ period ->\n                        ApprovalEntity(\n                            room = room,\n                            period = period\n                        )\n                    }\n                }\n                approvalJpaRepository.saveAll(approvals)\n                println(\"Approval 데이터가 성공적으로 추가되었습니다.\")\n\n                // 교사 생성\n                val teachers = (1..3).map {\n                    UserEntity(\n                        email = \"teacher$it@example.com\",\n                        username = \"교사$it\",\n                        role = UserRole.TEACHER,\n                        currentStatus = AttendanceType.CLASS\n                    )\n                }\n                userJpaRepository.saveAll(teachers)\n\n                // 학생 및 출석 데이터 생성\n                val students = mutableListOf<UserEntity>()\n                val attendances = mutableListOf<AttendanceEntity>()\n                val attendanceTypes = AttendanceType.values()\n\n                for (i in 1..20) {\n                    val grade = (1..3).random()\n                    val cls = (1..4).random()\n                    val num = (1..20).random()\n\n                    val student = UserEntity(\n                        email = \"student$i@example.com\",\n                        username = \"학생$i\",\n                        role = UserRole.STUDENT,\n                        currentStatus = AttendanceType.NOT_ATTEND\n                    )\n                    students.add(student)\n                    val savedStudent = userJpaRepository.save(student)\n\n                    val studentInfo = StudentInfoEntity(\n                        user = savedStudent,\n                        grade = grade,\n                        cls = cls,\n                        num = num,\n                        cardId = \"CARD-ID-$i\"\n                    )\n                    studentInfoJpaRepository.save(studentInfo)\n\n\n                    for (period in listOf(8, 9, 10)) {\n                        val randomType = attendanceTypes[Random.nextInt(attendanceTypes.size)]\n                        val randomRoom = if (randomType != AttendanceType.NOT_ATTEND) rooms[Random.nextInt(rooms.size)] else null\n\n                        val attendance = AttendanceEntity(\n                            period = period,\n                            type = randomType,\n                            user = savedStudent,\n                            room = randomRoom,\n                            date = LocalDate.now()\n                        )\n                        attendances.add(attendance)\n                    }\n                }\n                attendanceJpaRepository.saveAll(attendances)\n\n                println(\"가짜 유저 및 출석 데이터가 성공적으로 추가되었습니다.\")\n            } else {\n                println(\"데이터가 이미 존재합니다. 추가하지 않습니다.\")\n            }\n        }\n    }\n}\n
